#ifndef MAIN_H
#define MAIN_H

#include "stack.h"
#include <SDL3/SDL.h>
#include <stdint.h>

#define MEMSIZE 4096

static uint32_t screen_state[64][32]= {0};

const uint8_t fonts[80] = {
    0xF0, 0x90, 0x90, 0x90, 0xF0, // 0
    0x20, 0x60, 0x20, 0x20, 0x70, // 1
    0xF0, 0x10, 0xF0, 0x80, 0xF0, // 2
    0xF0, 0x10, 0xF0, 0x10, 0xF0, // 3
    0x90, 0x90, 0xF0, 0x10, 0x10, // 4
    0xF0, 0x80, 0xF0, 0x10, 0xF0, // 5
    0xF0, 0x80, 0xF0, 0x90, 0xF0, // 6
    0xF0, 0x10, 0x20, 0x40, 0x40, // 7
    0xF0, 0x90, 0xF0, 0x90, 0xF0, // 8
    0xF0, 0x90, 0xF0, 0x10, 0xF0, // 9
    0xF0, 0x90, 0xF0, 0x90, 0x90, // A
    0xE0, 0x90, 0xE0, 0x90, 0xE0, // B
    0xF0, 0x80, 0x80, 0x80, 0xF0, // C
    0xE0, 0x90, 0x90, 0x90, 0xE0, // D
    0xF0, 0x80, 0xF0, 0x80, 0xF0, // E
    0xF0, 0x80, 0xF0, 0x80, 0x80  // F
};

static int8_t memory[MEMSIZE];
static int16_t program_counter;
static int16_t i;             // index register
static int8_t v[16];          // general purpose variables registers
static Stack functions_stack; // functions / subroutines stack
static int8_t delay_timer;    // decremented at rate of 60hz until 0
static int8_t audio_timer;    // like delay_timer, beeps at numbers != 0

void close_sdl(SDL_Window *window, SDL_Renderer *renderer);
void render(SDL_Renderer *renderer);
void set_pixel_color(SDL_Surface* surface,const int x, const int y, const uint32_t color);

void init_emulator(); // loads stuff into memory and bootstraps the system
void execute_cycle();

#endif // !MAIN_H
